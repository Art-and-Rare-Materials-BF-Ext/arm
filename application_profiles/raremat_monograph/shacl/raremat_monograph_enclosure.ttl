@prefix activity: <https://w3id.org/arm/core/activity/0.1/> .
@prefix arm: <https://w3id.org/arm/core/ontology/0.1/> .
@prefix bf: <http://id.loc.gov/ontologies/bibframe/> .
@prefix dcterms: <http://purl.org/dc/terms/> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix skos: <http://www.w3.org/2004/02/skos/core#> .
@prefix swa: <http://topbraid.org/swa#> .
@prefix tosh: <http://topbraid.org/tosh#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .

@prefix : <https://w3id.org/arm/application_profiles/raremat_monograph/shacl/raremat_monograph_enclosure/> .
@prefix arm_core_property_shapes: <https://w3id.org/arm/core/validation/shacl/arm_core_property_shapes/> .

# TODO Resolve this namespace with the one defined in the file.
@prefix raremat_monograph_form: <https://w3id.org/arm/application_profiles/raremat_monograph/shacl/raremat_monograph_form/> .

@prefix raremat_monograph_activity: <https://w3id.org/arm/application_profiles/raremat_monograph/shacl/raremat_monograph_activity/> .
@prefix raremat_monograph_marking: <https://w3id.org/arm/application_profiles/raremat_monograph/shacl/raremat_monograph_marking/> .
@prefix raremat_monograph_note: <https://w3id.org/arm/application_profiles/raremat_monograph/shacl/raremat_monograph_note/> .

# TODO Resolve this namespace with the one defined in the file. 
@prefix raremat_monograph_property_groups: <https://w3id.org/arm/application_profiles/shacl/raremat_monograph_property_groups/> . 


# Links resource (generally Instance or Item) to Enclosure 
:RareMatForm_dcterms_hasPart_arm_Enclosure
    sh:and (
        arm_core_property_shapes:dcterms_hasPart
        [
            sh:class arm:Enclosure ;
            # NON-VALIDATING   
            sh:name "Enclosure" ; 
            sh:description "A resource that encloses this resource, such as a binding, dust jacket, slip case, wrap around band, or wrapper on a book." ;  
            # TODO Depends on using a general PhysicalDescriptionPropertyGroup.
            # If not, remove here and conjoin this with the property group definition,
            # one for instance and one for item.
            sh:group raremat_monograph_property_groups:PhysicalDescriptionPropertyGroup ;   
            sh:order "0"^^xsd:decimal ;   
            tosh:editWidget swa:NestedObjectEditor ;             
        ]
    ) ;
    .

:EnclosureForm
    a sh:NodeShape ;
    rdfs:label "Enclosure" ;
    sh:targetClass arm:Enclosure ;
    sh:property
        :EnclosureForm_activity_hasActivity ,    
        :EnclosureForm_arm_hasMaterial ,  
        # Uses general MarkingForm, no special constraints needed
        raremat_monograph_marking:arm_markedBy ,
        :EnclosureForm_bf_note ,   
        :EnclosureForm_crm_P2_has_type ,   
        :EnclosureForm_dcterms_hasPart ; 
    .
    
##### ENCLOSURE ACTIVITY #####

:EnclosureForm_activity_hasActivity
    sh:and (
        arm_core_property_shapes:activity_hasActivity 
        [
            # NON-VALIDATING
            sh:name "Agent" ;
            sh:description "Agent related to the Enclosure: binder, designer, creator, etc." ;
            sh:group raremat_monograph_property_groups:ActivityPropertyGroup ;
            sh:order "0"^^xsd:decimal ;
            tosh:editWidget swa:NestedObjectEditor ;       
        ]
    ) ;
    .
    
:EnclosureActivityForm
    sh:and (
        raremat_monograph_activity:ActivityForm
        [
            sh:property :EnclosureActivityForm_rdf_type ;
        
        ]
    ) ;     
    .
 
:EnclosureActivityForm_rdf_type 
    sh:and (
        arm_core_property_shapes:rdf_type 
        [
            sh:in (
                arm:BinderActivity
                arm:CreatorActivity
                arm:DesignerActivity
            ) ;       
        ]
    ) ;
    .  
    
    
#:EnclosureForm_arm_hasMaterial

##### ENCLOSURE NOTE #####

:EnclosureForm_bf_note
    sh:and (
        arm_core_property_shapes:bf_note 
        [       
            # NON-VALIDATING
            sh:name "Enclosure note" ; 
            sh:description "Additional textual notes about this enclosure." ;     
            sh:order "0"^^xsd:decimal ;   
            tosh:editWidget swa:NestedObjectEditor ;
        ]
    ) ;
    .

:EnclosureNoteForm
    sh:and (
        raremat_monograph_note:NoteForm
        [
            sh:property :EnclosureNoteForm_rdf_type ;
        
        ]
    ) ;     
    .
 
:EnclosureNoteForm_rdf_type 
    sh:and (
        arm_core_property_shapes:rdf_type 
        [
            sh:in (
                arm:DescriptiveNote
                bf:Note
            ) ;       
        ]
    ) ;
    . 
    
#:EnclosureForm_crm_P2_has_type # + vocab 

#:EnclosureForm_dcterms_has_part # + vocab





    
  
    